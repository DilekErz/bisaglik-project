<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		   <title>Ä°laÃ§ Listesi</title>
	</head>
	<body>
		<h2>Ä°laÃ§ Listesi</h2>
		
		<!---ilaÃ§larÄ± arama kutusu (textbox, button)-->
		<form th:action="@{/drugs/search}" method="get">
			<input type="text" name="keyword" placeholder="ilaÃ§ adÄ± veya barkod ara..."/>
			<button type="submit">Ara</button>	
		</form>
		
		
		<div sec:authorize="hasRole('ADMIN')">
		<a th:href="@{/drugs/add}">
		    <button>â• Yeni Ä°laÃ§ Ekle</button>
		</a>
		</div>
		<br><br>
		
		<div style="text-align: right; margin-bottom: 10px;">
		    <a th:href="@{/cart}">
		        <button style="background-color: orange; padding: 6px 12px;">
		            ğŸ›’ Sepetim <!--(<span th:text="${cartSize}">0</span>)-->
		        </button>
		    </a>
		</div>
		
		<div th:if="${message}" style="color: green; font-weight: bold; margin-bottom: 10px;">
		    <p th:text="${message}"></p>
		</div>

		
		<table border="1">
			<tr>
				<th>Ä°sim</th>
				<th>Barkod NumarasÄ±</th>
				<th>Stok</th>
				<th>Fiyat (â‚º)</th>
				<th sec:authorize="hasRole('ADMIN')">Ä°ÅŸlemler</th>
			</tr>
			<tr th:each="drug : ${drugs}"> <!---Java'dan gelen drugs listesindeki her ilacÄ± tek tek dÃ¶ner.--->
				<td th:text="${drug.name}"></td>
				  <td th:text="${drug.barcodeNumber}"></td>
				<td th:text="${drug.stock}"></td>	
				<!-- Ä°laÃ§larÄ±n adÄ±, Ã¼reticisi ve stok bilgileri tabloda gÃ¶sterilir.-->	
				
				<td th:text="${drug.price} + ' â‚º'"></td> <!-- Veriyi gÃ¶steren kÄ±sma -->
				
				

				<!-- Admin iÅŸlemleri -->
				<td sec:authorize="hasRole('ADMIN')">
				    <a th:href="@{'/drugs/update/' + ${drug.id}}">
						<button>âœï¸ GÃ¼ncelle</button></a>
				    <a th:href="@{'/drugs/delete/' + ${drug.id}}"
				       onclick="return confirm('Bu ilacÄ± silmek istediÄŸinize emin misiniz?')">
				        <button style="color:red">ğŸ—‘ï¸ Sil</button>
				    </a>
				</td>

				<!-- User iÅŸlemleri -->
				<td>
					<form th:action="@{'/cart/add/' + ${drug.id}}" method="post" style="display:inline;">
					    <input type="number" name="quantity" value="1" min="1" style="width:50px;" required>
					    
					    <!-- Eczane ID gizli olarak gÃ¶nderiliyor -->
					    <input type="hidden" name="pharmacyId" th:value="${drug.pharmacy.id}" />
					    
					    <button type="submit">ğŸ›’ Sepete Ekle</button>
					</form>



				</td>
				
				
				
				</tr>
				
				<!--Controllerâ€™dan gelen liste HTML iÃ§inde th: ifadeleriyle gÃ¶sterilir.--->
		</table>
	</body>
	
</html>